(this["webpackJsonpreact-pangul"]=this["webpackJsonpreact-pangul"]||[]).push([[0],Array(41).concat([function(e,t,n){e.exports=n(87)},,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(22),s=n(7),u=n(4),c=n(3),i=n(5),o=n(6),p=n(10),l=n(13),h=n(1),f=n.n(h),v=n(2),d=n(18),m=n(39),b=n(89),w=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),r=t.call(this,e||{}),e||r._unsafeAssignState(r.blank()),r.rebind(),r}return Object(c.a)(n,[{key:"update",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(Object(d.a)(n.prototype),"update",this).call(this,t);case 2:this.rebind();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"state",get:function(){return this.props}}]),n}(function(){function e(t){Object(u.a)(this,e),this.parent=void 0,this.props=void 0,this.error=void 0,this.updating=void 0,this.updateDepth=0,this.observer=new b.a,this.error=null,this.updating=!1,this.parent=null,this.props={},this._unsafeAssignState(t)}return Object(c.a)(e,[{key:"subscribe",value:function(e){var t=this.observer.subscribe(e);return function(){t.unsubscribe()}}},{key:"update",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._startUpdate(),e.prev=1,e.next=4,t();case 4:(n=e.sent)&&(this.props=Object(s.a)({},this.props,{},n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.error=e.t0;case 11:this._completedUpdate();case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_startUpdate",value:function(){this.updateDepth+=1,this.updating=!0,this.error=null,1===this.updateDepth&&this.observer.next(this),this.parent&&this.parent._startUpdate()}},{key:"_completedUpdate",value:function(){this.updateDepth-=1,0===this.updateDepth&&(this.updating=!1,this.parent&&this.parent._completedUpdate(),this.observer.next(this))}},{key:"_unsafeAssignState",value:function(t){if(t){this.props=t;try{for(var n=0,r=Object.entries(t);n<r.length;n++){var a=r[n];a[1]instanceof e&&(a[1].parent=this)}}catch(s){}}}}]),e}()),k=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"reset",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{loggedIn:!1,permissions:[],username:"anonymous user"}}},{key:"rebind",value:function(){}}]),n}(w),y=(n(47),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutTheme"},this.props.children)}}]),n}(r.Component)),j=(n(48),function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,[{key:"get",value:function(){var e=this.provide();if(!e)throw new Error("Provider not configured");return e}}]),e}()),O=new(function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this)).factory=e,r}return Object(c.a)(n,[{key:"configure",value:function(e){this.factory=e}},{key:"provide",value:function(){return null==this.factory?null:this.factory()}}]),n}(j))(null),x=n(38),g=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e,r){var a;return Object(u.a)(this,n),(a=t.call(this,e)).innerErrors={},a.innerErrors=r,a}return n}(Object(x.a)(Error)),E=function(){function e(t){Object(u.a)(this,e),this.rootUrl=t}return Object(c.a)(e,null,[{key:"serializeRequestBody",value:function(e){try{return JSON.stringify(e)}catch(n){var t=O.get();throw t.info("Unable to serialize object",e),t.error(n),new Error("Request failed: Unable to serialize object for POST")}}}]),Object(c.a)(e,[{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.rootUrl).concat(t),{method:"GET"});case 2:if((n=e.sent).ok){e.next=5;break}throw new Error(n.statusText);case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var t=Object(v.a)(f.a.mark((function t(n,r){var a,s,u,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new Headers({Accept:"*/*","Content-Type":"application/json","X-Requested-With":"PANGUL"}),t.prev=1,s=e.serializeRequestBody(r),t.next=5,fetch("".concat(this.rootUrl).concat(n),{body:s,cache:"no-cache",credentials:"include",headers:a,method:"POST",mode:"cors",redirect:"follow"});case 5:if((u=t.sent).ok){t.next=17;break}return t.prev=7,t.next=10,u.json();case 10:return c=t.sent,t.abrupt("return",{error:new g(c.result,c.errors),success:!1});case 14:return t.prev=14,t.t0=t.catch(7),t.abrupt("return",{error:new Error("Request failed: ".concat(u.status,": ").concat(u.statusText)),success:!1});case 17:return t.next=19,u.json();case 19:return t.abrupt("return",t.sent);case 22:return t.prev=22,t.t1=t.catch(1),t.abrupt("return",{error:t.t1,success:!1});case 25:case"end":return t.stop()}}),t,this,[[1,22],[7,14]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),q=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,[{key:"error",value:function(e){e&&window.console.error(e)}},{key:"info",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];(t=window.console).log.apply(t,[e].concat(r))}}]),e}(),C=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this)).instance=e,r}return Object(c.a)(n,[{key:"configure",value:function(e){this.instance=e}},{key:"provide",value:function(){return this.instance}}]),n}(j),S=new C(null),I=new C(null);var N,T=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,[{key:"post",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch.post(t,n);case 2:if(!(r=e.sent).success){e.next=5;break}return e.abrupt("return",r.data);case 5:if(this.logger.error(r),null==r.error){e.next=8;break}throw r.error;case 8:throw new Error("Internal server error");case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetch",get:function(){return S.get()}},{key:"logger",get:function(){return O.get()}}]),e}(),D=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"login",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/auth/login",{username:t,password:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/auth/logout",null);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"claims",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.post("/api/auth/claims",null));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(T),P=function(){function e(){Object(u.a)(this,e),this.authController=void 0,this.authController=new D}return Object(c.a)(e,[{key:"login",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){var a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.authController.login(n,r);case 2:return e.next=4,a.authController.claims();case 4:return t=e.sent,e.abrupt("return",{loggedIn:!0,permissions:t.claims,username:t.token});case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.authController.logout();case 2:return e.next=4,t.reset();case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasPermissions",value:function(e,t){return 0!==t.length&&(null!=e&&0===t.filter((function(t){return!e.state.permissions.find((function(e){return e===t}))})).length)}},{key:"refresh",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(Object(v.a)(f.a.mark((function e(){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.authController.claims();case 3:return r=e.sent,e.abrupt("return",{loggedIn:!0,permissions:r.claims,username:r.token});case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,t.reset();case 11:return e.abrupt("return",t.state);case 12:case"end":return e.stop()}}),e,null,[[0,7]])}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),F=(n(49),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return this.props.loading?r.createElement("div",{className:"component--PageLoader"},r.createElement("div",null,"loading")):r.createElement(r.Fragment,null)}}]),n}(r.Component)),U=(n(50),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutContentContainer"},this.props.children)}}]),n}(r.PureComponent)),A=(n(51),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).innerRef=void 0,a.innerRef=r.createRef(),a}return Object(c.a)(n,[{key:"render",value:function(){return this.props.error?(this.scrollAsync(),r.createElement("div",{className:"component--ErrorNotice",ref:this.innerRef},r.createElement("em",null,this.props.error.message),this.renderInnerErrors())):r.createElement(r.Fragment,null)}},{key:"renderInnerErrors",value:function(){if(null==this.props.error||!this.props.error.innerErrors)return"";for(var e=[],t=0,n=Object.entries(this.props.error.innerErrors);t<n.length;t++){var a=n[t];e.push(r.createElement("li",{key:a[0]},a[0],": ",a[1]))}return r.createElement("ul",null,e)}},{key:"scrollAsync",value:function(){var e=this;setTimeout((function(){null!=e.innerRef.current&&a.findDOMNode(e.innerRef.current).scrollIntoView({block:"end",behavior:"smooth"})}),1)}}]),n}(r.Component)),Q=(n(52),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutFormContainer"},r.createElement(A,{error:this.props.error}),this.props.children)}}]),n}(r.Component)),V=(n(53),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.expand?"static":"absolute";return r.createElement("div",{className:"component--LayoutRightBox",style:{position:e}},this.props.children)}}]),n}(r.PureComponent)),L=(n(54),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onSubmitLogin=function(e){e.preventDefault(),(new P).login(r.props.user,r.state.username,r.state.password)},r.onUsernameChange=function(e){r.setState({username:e.currentTarget.value})},r.onPasswordChange=function(e){r.setState({password:e.currentTarget.value})},r.state={password:"...",username:"username"},r}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--GenericLoginPage"},r.createElement(F,{loading:this.props.user.updating}),r.createElement(U,null,r.createElement("h3",{className:"notice"},"Login required")),r.createElement(Q,{error:this.props.user.error},r.createElement("form",{onSubmit:this.onSubmitLogin},r.createElement("fieldset",null,r.createElement("input",{type:"text",value:this.state.username,onChange:this.onUsernameChange})),r.createElement("fieldset",null,r.createElement("input",{type:"password",value:this.state.password,onChange:this.onPasswordChange})),r.createElement(V,{expand:!0},r.createElement("button",null,"Login")))))}}]),n}(r.Component)),z=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).unsubscribe=null,r.state={refreshed:!1,user:null},r}return Object(c.a)(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.user!==t.user?{user:e.user,refreshed:!1}:null}}]),Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}},{key:"componentDidMount",value:function(){this.resubscribe()}},{key:"render",value:function(){var e=this.props.user.state.loggedIn?this.props.renderLoggedIn():this.props.renderLoggedOut();return r.createElement(r.Fragment,null,e)}},{key:"componentDidUpdate",value:function(){this.state.refreshed||this.resubscribe()}},{key:"resubscribe",value:function(){var e=this;this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.state.user&&Object(v.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.user){t.next=5;break}return e.unsubscribe=e.state.user.subscribe((function(){e.forceUpdate()})),n=new P,t.next=5,n.refresh(e.props.user);case 5:case"end":return t.stop()}}),t)})))().then((function(){e.setState({refreshed:!0})}))}}]),n}(r.Component),M=n(34),R=n(35),B=(n(55),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){return Object(u.a)(this,n),t.call(this,e)}return Object(c.a)(n,null,[{key:"safe",value:function(e){return R(e,{allowProtocolRelative:!0,allowedAttributes:{a:["href","name","target"],img:["src"]},allowedIframeHostnames:[],allowedTags:["h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre","iframe","img"],allowedSchemes:["http","https"],allowedSchemesAppliedToAttributes:["href","src","cite"],allowedSchemesByTag:{},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"]})}}]),Object(c.a)(n,[{key:"render",value:function(){var e=n.safe(this.props.value);return r.createElement("div",{className:"component--SafeHtml",dangerouslySetInnerHTML:{__html:e}})}}]),n}(r.Component)),W=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).converter=void 0,r.converter=new M.Converter,r}return Object(c.a)(n,[{key:"render",value:function(){try{var e=this.converter.makeHtml(this.props.markdown);return r.createElement(r.Fragment,null,r.createElement(B,{value:e}))}catch(t){return r.createElement(A,{error:t})}}}]),n}(r.PureComponent),H=(n(56),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).events={},r.state={lastPropValue:"",value:""},r.events={onChange:function(e){return r.onChange(e)}},r}return Object(c.a)(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.lastPropValue?{value:e.value,lastPropValue:e.value}:null}}]),Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--MarkdownEditor"},r.createElement("textarea",{value:this.state.value,onChange:this.events.onChange}),r.createElement("div",{className:"rendered"},r.createElement(W,{markdown:this.state.value})))}},{key:"onChange",value:function(e){var t=this,n=e.currentTarget.value;this.setState({value:n},(function(){t.props.onChange(n)}))}}]),n}(r.Component)),_=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).events={},r.unsubscribe=null,r.state={lastUpdate:new Date},r.events={onBodyChanged:function(e){return r.onBodyChanged(e)},onSave:function(e){return r.onSave(e)}},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.props.answer.subscribe((function(){e.setState({lastUpdate:new Date})}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}},{key:"render",value:function(){return r.createElement("div",{className:"component--Answer"},r.createElement("form",{action:"",onSubmit:this.events.onSave},r.createElement("fieldset",null,r.createElement(H,{value:this.props.answer.state.body,onChange:this.events.onBodyChanged})),r.createElement("fieldset",{className:"buttons"},r.createElement("button",{className:"submit"},this.props.saveText))))}},{key:"onSave",value:function(e){e.preventDefault(),this.props.submit()}},{key:"onBodyChanged",value:function(e){this.props.answer.update(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{body:e});case 1:case"end":return t.stop()}}),t)}))))}}]),n}(r.Component),G=(n(57),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).innerRef=void 0,a.innerRef=r.createRef(),a}return Object(c.a)(n,[{key:"render",value:function(){return this.props.value?(this.scrollAsync(),r.createElement("div",{className:"component--InfoNotice",ref:this.innerRef},this.props.value)):r.createElement(r.Fragment,null)}},{key:"scrollAsync",value:function(){var e=this;setTimeout((function(){null!=e.innerRef.current&&a.findDOMNode(e.innerRef.current).scrollIntoView({block:"end",behavior:"smooth"})}),1)}}]),n}(r.Component)),J=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"delete",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/topics/delete",{RowVersion:t.rowVersion,TopicId:t.topicId});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return e.next=3,this.post("/api/topics/get",{TopicId:n});case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,this.post("/api/topics/get",{TopicName:t});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/topics/update",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/topics/search",{limit:r,offset:n,query:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(T),$=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"fetch",value:function(e){var t=this;return this.update(Object(v.a)(f.a.mark((function n(){var r,a,s,u;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e<=0?0:e*t.state.pageSize,n.next=3,t.state.fetchIds(t.state.query,r,t.state.pageSize);case 3:return a=n.sent,s=a.identityList.map((function(e){return t.state.fetchInstance(e)})),n.next=7,Promise.all(s);case 7:return u=n.sent,n.abrupt("return",{instances:u,moreResults:a.moreResults,page:e});case 9:case"end":return n.stop()}}),n)}))))}},{key:"next",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.state.moreResults){e.next=2;break}throw new Error("No more results in QuerySet");case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e)}))));case 2:if(this.error){e.next=5;break}return e.next=5,this.fetch(this.state.page+1);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.state.page<=0)){e.next=2;break}throw new Error("Already on first page of QuerySet");case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e)}))));case 2:if(this.error){e.next=5;break}return e.next=5,this.fetch(this.state.page-1);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{fetchIds:function(){return Promise.reject(new Error("Not implemented"))},fetchInstance:function(){return Promise.reject(new Error("Not implemented"))},instances:[],moreResults:!1,page:0,pageSize:10,query:""}}},{key:"rebind",value:function(){var e=this;this.state.instances.map((function(t){t.parent=e}))}}],[{key:"fromQuery",value:function(){var e=Object(v.a)(f.a.mark((function e(t,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new n(Object(s.a)({},t,{instances:[],moreResults:!1,page:-1})),null===r||void 0===r){e.next=4;break}return e.next=4,a.fetch(r);case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w),X=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"delete",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new J,e.next=3,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.delete(n.state);case 2:return e.abrupt("return",n.blank());case 3:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchData(t.state.name,t.state.topicId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new J,e.next=3,this.update(Object(v.a)(f.a.mark((function e(){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(s.a)({},n.state),n.state.topicId){e.next=3;break}throw new Error("Topics can only be auto-generated, use Topic.get");case 3:return e.next=5,t.update(r);case 5:return e.next=7,n.fetchData(n.state.name,null);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{description:"",icon:"",name:"",rowVersion:"",topicId:""}}},{key:"fetchData",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new J,e.next=3,r.get(t,n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){}}],[{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new n).state.name=t,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $.fromQuery({fetchIds:n.searchForIds,fetchInstance:n.getById,pageSize:t,query:e},r)}},{key:"getById",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new n).state.topicId=t,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchForIds",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new J,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(w),Y=function(){function e(){Object(u.a)(this,e),this.root=void 0,this.root=I.get().baseUrl,this.root.endsWith("/")&&(this.root=this.root.replace(/\/*$/,""))}return Object(c.a)(e,[{key:"urlForAnswerEdit",value:function(e,t,n){return"".concat(this.root,"/t/").concat(e,"/").concat(t,"/answer/").concat(n,"/edit")}},{key:"urlForQuestion",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/").concat(t)}},{key:"urlForQuestionEdit",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/").concat(t,"/edit")}},{key:"urlForTopic",value:function(e){return"".concat(this.root,"/t/").concat(e)}},{key:"urlForTopicEdit",value:function(e){return"".concat(this.root,"/t/").concat(e,"/edit")}},{key:"urlForTopicAddQuestion",value:function(e){return"".concat(this.root,"/t/").concat(e,"/ask")}},{key:"urlForQuestionAnswer",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/").concat(t,"/answer")}},{key:"urlForHelp",value:function(){return"".concat(this.root,"/help")}},{key:"urlForRoot",value:function(){return"".concat(this.root)}},{key:"urlForLogout",value:function(){return"".concat(this.root,"/logout")}},{key:"urlForSelfProfile",value:function(){return"".concat(this.root,"/self")}},{key:"urlForTopicQuery",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/search/").concat(t)}},{key:"redirect",value:function(e){window.location.href=e}}]),e}();n(58);!function(e){e[e.AddQuestion=0]="AddQuestion",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.None=3]="None"}(N||(N={}));var K,Z=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).nav=void 0,r.nav=new Y,r}return Object(c.a)(n,[{key:"render",value:function(){if(!this.props.topic)return r.createElement(r.Fragment,null);var e=this.getUrl();return r.createElement("div",{className:"component--TopicLink"},r.createElement(p.b,{to:e},this.props.children))}},{key:"getUrl",value:function(){switch(this.props.target){case N.AddQuestion:return this.nav.urlForTopicAddQuestion(this.props.topic);case N.View:return this.nav.urlForTopic(this.props.topic);case N.Edit:return this.nav.urlForTopicEdit(this.props.topic);case N.None:return this.nav.urlForRoot();default:throw new Error("Unsupported target")}}}]),n}(r.Component),ee=(n(63),function(e){if(e.topicId){var t=e.description||"no description";return r.createElement("div",{className:"desc"},r.createElement(Z,{target:N.Edit,topic:e.name},t))}return r.createElement("div",{className:"desc"})}),te=function(e){return e.icon?r.createElement("div",{className:"icon"},r.createElement("img",{src:e.icon})):r.createElement(r.Fragment,null)},ne=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.name||"no topic",t=this.props.name?N.View:N.None;return r.createElement("div",{className:"component--TopicInfo"},r.createElement(te,this.props),r.createElement("div",null,r.createElement(Z,{target:t,topic:e},r.createElement("h1",{className:"header"},e)),r.createElement(ee,this.props)))}}]),n}(r.Component),re=(n(64),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).nav=new Y,e}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--UserCurrentInfo"},r.createElement("div",null,r.createElement(p.b,{to:this.nav.urlForSelfProfile()},this.props.user.username)),r.createElement("div",{className:"logout"},r.createElement(p.b,{to:this.nav.urlForLogout()},"logout")))}}]),n}(r.Component)),ae=(n(65),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=I.get(),t=new Y;return r.createElement("div",{className:"component--LayoutFooter"},r.createElement("div",null,r.createElement("div",{className:"message"},e.footerNotice),r.createElement("div",{className:"home"},r.createElement(p.b,{to:t.urlForRoot()},"Home")),r.createElement("div",{className:"help"},r.createElement(p.b,{to:t.urlForHelp()},"Help"))))}}]),n}(r.PureComponent)),se=(n(66),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.topic||(new X).state;return r.createElement(r.Fragment,null,r.createElement("div",{className:"component--LayoutStandardHeader"},r.createElement(F,{loading:this.props.loading}),r.createElement(ne,e),r.createElement(re,{user:this.props.user})),r.createElement(ae,null))}}]),n}(r.Component));n(67);!function(e){e[e.Answer=0]="Answer",e[e.View=1]="View",e[e.Edit=2]="Edit"}(K||(K={}));var ue=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).nav=void 0,r.nav=new Y,r}return Object(c.a)(n,[{key:"render",value:function(){if(!this.props.question)return r.createElement(r.Fragment,null);var e=this.getUrl();return r.createElement(p.b,{to:e},this.props.children)}},{key:"getUrl",value:function(){var e=this.props.question.state.topic,t=this.props.question.state.questionId;switch(this.props.target){case K.View:return this.nav.urlForQuestion(e,t);case K.Edit:return this.nav.urlForQuestionEdit(e,t);case K.Answer:return this.nav.urlForQuestionAnswer(e,t);default:throw new Error("Unsupported target")}}}]),n}(r.Component),ce=(n(68),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutRightBottom"},this.props.children)}}]),n}(r.PureComponent)),ie=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return this.props.show?r.createElement(r.Fragment,null,this.props.children):r.createElement(r.Fragment,null)}}]),n}(r.PureComponent),oe=(n(69),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onVoteUp=Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.props.userVotes){t.next=5;break}return t.next=3,e.props.onVote(0);case 3:t.next=7;break;case 5:return t.next=7,e.props.onVote(1);case 7:case"end":return t.stop()}}),t)}))),e.onVoteDown=Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==e.props.userVotes){t.next=5;break}return t.next=3,e.props.onVote(0);case 3:t.next=7;break;case 5:return t.next=7,e.props.onVote(-1);case 7:case"end":return t.stop()}}),t)}))),e.onStar=Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.props.showStars&&e.props.onStar){t.next=2;break}return t.abrupt("return");case 2:if(!(e.props.userStars>0)){t.next=7;break}return t.next=5,e.props.onStar(0);case 5:t.next=9;break;case 7:return t.next=9,e.props.onStar(1);case 9:case"end":return t.stop()}}),t)}))),e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.userVotes>0?["up","active"]:["up"],t=this.props.userVotes<0?["down","active"]:["down"],n=this.props.userStars>0?["star","active"]:["star"];return r.createElement("div",{className:"component--VotesAndStars"},r.createElement("li",null,r.createElement("div",{className:e.join(" "),onClick:this.onVoteUp})),r.createElement("li",null,r.createElement("div",{className:"votes"},this.props.votes)),r.createElement("li",null,r.createElement("div",{className:t.join(" "),onClick:this.onVoteDown})),r.createElement(ie,{show:this.props.showStars},r.createElement("li",{className:"star-container"},r.createElement("div",{className:n.join(" "),onClick:this.onStar}))))}}]),n}(r.Component)),pe=(n(70),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).nav=void 0,r.nav=new Y,r}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.props.tags.map((function(t){if(null==e.props.topic)return r.createElement("div",{key:t,className:"tag"},t);var n=e.nav.urlForTopicQuery(e.props.topic,"tag:".concat(t));return r.createElement("div",{key:t,className:"tag"},r.createElement(p.b,{to:n},t))}));return 0===t.length?r.createElement(r.Fragment,null):r.createElement("div",{className:"component--TagList"},this.props.tags.length>0?t:"No tags")}}]),n}(r.Component)),le=(n(71),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--UserSummary"},"by: ",this.props.user.state.username)}}]),n}(r.PureComponent)),he=(n(72),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onVote=function(){var t=Object(v.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n>0)){t.next=5;break}return t.next=3,e.props.question.state.meta.voteUp();case 3:t.next=12;break;case 5:if(!(n<0)){t.next=10;break}return t.next=8,e.props.question.state.meta.voteDown();case 8:t.next=12;break;case 10:return t.next=12,e.props.question.state.meta.voteNeutral();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onStar=function(){var t=Object(v.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=5;break}return t.next=3,e.props.question.state.meta.addStar();case 3:t.next=7;break;case 5:return t.next=7,e.props.question.state.meta.removeStar();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.question.state.meta;return r.createElement("div",{className:"component--QuestionView"},r.createElement("div",{className:"metadata"},r.createElement(oe,{showStars:!0,userStars:e.state.star?1:0,userVotes:e.state.votes,votes:e.state.global.votes,onVote:this.onVote,onStar:this.onStar})),r.createElement("div",{className:"output"},r.createElement("h2",null,this.props.question.state.title),r.createElement(pe,{tags:this.props.question.state.tags,topic:this.props.question.state.topic}),r.createElement(W,{markdown:this.props.question.state.body}),r.createElement(ce,null,r.createElement(le,{user:this.props.question.state.user}))))}}]),n}(r.Component)),fe=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"add",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/add",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/delete",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/get",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/metadata",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateMetadata",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/updateMetadata",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/update",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/search",{limit:r,offset:n,questionId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(T),ve=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"voteUp",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:1}));case 3:return e.next=5,n.getMetadata(t.state.answerId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"voteNeutral",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:0}));case 3:return e.next=5,n.getMetadata(t.state.answerId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"voteDown",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:-1}));case 3:return e.next=5,n.getMetadata(t.state.answerId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answerId:"",answerMetaId:"",global:{votes:0},rowVersion:"",votes:0}}},{key:"rebind",value:function(){}}]),n}(w),de=new(function(){function e(){Object(u.a)(this,e),this.pending=null,this.requests={}}return Object(c.a)(e,[{key:"get",value:function(t){var n=this.requests[t];return n?e.isExpired(n)?(delete this.requests[t],null):n.value:null}},{key:"set",value:function(e,t,n){this.requests[e]={expires:Date.now()+n,value:t}}},{key:"waitPending",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pending){e.next=3;break}return e.next=3,this.pending;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,this.pending=new Promise(function(){var e=Object(v.a)(f.a.mark((function e(r,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:n=e.sent,r(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()),e.next=4,this.pending;case 4:if(null!=n){e.next=6;break}throw new Error("No data returned from cache update query");case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"isExpired",value:function(e){return e.expires<Date.now()}}]),e}()),me=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/users/get::".concat(t),e.next=3,de.waitPending();case 3:if(!(r=de.get(n))){e.next=6;break}return e.abrupt("return",r);case 6:return e.next=8,de.update(Object(v.a)(f.a.mark((function e(){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.post("/api/users/get",{id:t});case 2:return r=e.sent,de.set(n,r,2e3),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(T),be=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"reset",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new me,e.next=3,n.get(t.state.userId);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{userId:"",username:""}}},{key:"rebind",value:function(){}}],[{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new n).state.userId=t,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(w),we=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"refresh",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchAnswerData(t.state.answerId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new fe,e.next=3,this.update(Object(v.a)(f.a.mark((function e(){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(delete(r=Object(s.a)({},n.state)).meta,delete r.user,n.state.answerId){e.next=10;break}return e.next=6,t.add(r);case 6:return a=e.sent,e.next=9,n.fetchAnswerData(a.answerId);case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,t.update(r);case 12:return e.next=14,n.fetchAnswerData(n.state.answerId);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.delete(t.state.answerId);case 3:return e.abrupt("return",t.blank());case 4:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answerId:"",body:"...",canEdit:!1,meta:new ve,questionId:"",rowVersion:"",user:new be,userId:""}}},{key:"fetchAnswerData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,a,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.get(t);case 3:return r=e.sent,e.t0=ve,e.next=7,n.getMetadata(t);case 7:return e.t1=e.sent,a=new e.t0(e.t1),e.next=11,be.get(r.userId);case 11:return u=e.sent,e.abrupt("return",Object(s.a)({},r,{meta:a,user:u}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){this.state.meta.parent=this}}],[{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new n).state.answerId=t,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $.fromQuery({fetchIds:n.searchForIds,fetchInstance:n.get,pageSize:t,query:e},r)}},{key:"searchForIds",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new fe,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(w),ke=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"add",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/add",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/delete",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/get",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/metadata",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSummary",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/getSummary",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateMetadata",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/updateMetadata",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/update",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/search",{limit:r,offset:n,query:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(T),ye=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"voteUp",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:1}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"voteNeutral",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:0}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"voteDown",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:-1}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addStar",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{star:!0}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeStar",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{star:!1}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{global:{votes:0},questionId:"",questionMetaId:"",rowVersion:"",star:!1,votes:0}}},{key:"rebind",value:function(){}}]),n}(w),je=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"delete",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ke,e.next=3,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.delete(n.state.questionId);case 2:return e.abrupt("return",{questionId:"",rowVersion:""});case 3:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchQuestionData(t.state.questionId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ke,e.next=3,this.update(Object(v.a)(f.a.mark((function e(){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(delete(r=Object(s.a)({},n.state)).meta,delete r.user,n.state.questionId){e.next=10;break}return e.next=6,t.add(r);case 6:return a=e.sent,e.next=9,n.fetchQuestionData(a.questionId);case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,t.update(r);case 12:return e.next=14,n.fetchQuestionData(n.state.questionId);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{body:"...",canEdit:!1,meta:new ye,questionId:"",rowVersion:"",tags:[],title:"new question",topic:"default",user:new be,userId:""}}},{key:"fetchQuestionData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,a,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.get(t);case 3:return r=e.sent,e.t0=ye,e.next=7,n.getMetadata(t);case 7:return e.t1=e.sent,a=new e.t0(e.t1),e.next=11,be.get(r.userId);case 11:return u=e.sent,e.abrupt("return",Object(s.a)({},r,{meta:a,user:u}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){this.state.meta.parent=this}}],[{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new n).state.questionId=t,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $.fromQuery({fetchIds:n.searchForIds,fetchInstance:n.get,pageSize:t,query:e},r)}},{key:"searchForIds",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new ke,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(w),Oe=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this)).isLoaded=!1,r.unsubscribe=void 0,r.unsubscribe=r.subscribe((function(){e()})),r}return Object(c.a)(n,[{key:"load",value:function(e){var t=this;this.isLoaded=!0,this.runAsync(Object(v.a)(f.a.mark((function n(){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.loadInitialData(e);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))))}},{key:"unload",value:function(){this.isLoaded&&(this.isLoaded=!1,this.unsubscribe())}},{key:"runAsync",value:function(e){setTimeout((function(){e().then((function(){}),(function(e){O.get().error(e)}))}),1)}}]),n}(w),xe=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"answerQuestion",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.state.answer.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{questionId:t.state.question.state.questionId});case 1:case"end":return e.stop()}}),e)}))));case 4:return e.next=6,this.state.answer.save();case 6:if(null!==this.state.answer.error){e.next=9;break}return e.next=9,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved answer"}));case 1:case"end":return e.stop()}}),e)}))));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,je.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.abrupt("return",{question:r,topic:n,answer:new we});case 11:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answer:new we,notice:null,question:new je,topic:new X}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this,this.state.answer.parent=this}}]),n}(Oe),ge=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.answerQuestionEvent=function(){return r.data.answerQuestion()},r.data=new xe((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new xe((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.answer,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(se,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(U,null,r.createElement(V,{expand:!1},r.createElement(ue,{question:e,target:K.View},"View full question")),r.createElement(he,{question:e})),r.createElement(Q,{error:this.data.state.question.error},r.createElement(G,{value:this.data.state.notice}),r.createElement(_,{submit:this.answerQuestionEvent,answer:t,saveText:"Save"})))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component),Ee=(n(73),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).toggleOpenState=function(){r.setState({open:!r.state.open})},r.state={open:!1},r}return Object(c.a)(n,[{key:"render",value:function(){return this.state.open?r.createElement("div",{className:"component--LayoutUnsafeBox"},r.createElement("div",{className:"header",onClick:this.toggleOpenState},this.props.title),this.props.children):r.createElement("div",{className:"component--LayoutUnsafeBox"},r.createElement("div",{className:"header",onClick:this.toggleOpenState},this.props.title))}}]),n}(r.Component)),qe=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).auth=new P,e}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement(r.Fragment,null,this.authorized()?this.props.children:r.createElement(r.Fragment,null))}},{key:"authorized",value:function(){return this.auth.hasPermissions(this.props.user,this.props.requirePermissions)}}]),n}(r.Component),Ce=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement(qe,{user:this.props.user,requirePermissions:this.props.permissions},r.createElement(U,null,r.createElement(Ee,{title:"Unsafe commands"},r.createElement("form",null,r.createElement("fieldset",null,this.props.children)))))}}]),n}(r.Component),Se=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"saveAnswer",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.state.answer.save();case 4:if(null!==this.state.answer.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved answer"}));case 1:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteAnswer",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.answer.delete();case 2:t=new Y,n=this.state.question,t.redirect(t.urlForQuestion(n.state.topic,n.state.questionId));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,je.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.next=12,we.get(t.answer);case 12:if(!(a=e.sent).error){e.next=15;break}throw a.error;case 15:if(a.state.questionId===r.state.questionId){e.next=17;break}throw new Error("Invalid answer id for topic");case 17:return e.abrupt("return",{question:r,topic:n,answer:a});case 18:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answer:new we,notice:null,question:new je,topic:new X}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this,this.state.answer.parent=this}}]),n}(Oe),Ie=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.saveAnswerEvent=function(){return r.data.saveAnswer()},r.onDeleteQuestion=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,r.data.deleteAnswer();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.data=new Se((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Se((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.answer,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(se,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(U,null,r.createElement(he,{question:e})),r.createElement(Q,{error:this.data.state.answer.error},r.createElement(V,{expand:!0},r.createElement(ue,{question:e,target:K.View},"Close")),r.createElement(G,{value:this.data.state.notice}),r.createElement(_,{submit:this.saveAnswerEvent,answer:t,saveText:"Save"})),r.createElement(Ce,{user:this.props.user,permissions:["CanDelete:Answer"]},r.createElement(V,{expand:!0},r.createElement("p",null,"Delete this answer?"),r.createElement("p",null,"Careful! No undo for this!"),r.createElement("button",{onClick:this.onDeleteQuestion},"Delete answer"))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component),Ne=(n(74),function(e){return r.createElement("div",{className:"tip"},e.children)}),Te=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=new Y;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(U,null,r.createElement("h1",null,"Help"),r.createElement(Ne,null,"To start a new topic, just go to ",e.urlForTopic("NAME")),r.createElement(Ne,null,"Searching for tags:",r.createElement("code",null,"tag:name tag:name2 some search")),r.createElement(Ne,null,"Searching for anything in a topic:",r.createElement("code",null,"topic:name *")),r.createElement(Ne,null,"Searching in multiple topics:",r.createElement("code",null,"topic:name topic:other query")),r.createElement(Ne,null,"Searching in any topic:",r.createElement("code",null,"topic:* query"))),r.createElement(ae,null))}}]),n}(r.Component),De=(n(75),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onLogout=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.props.user,r.setState({redirect:!0},Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new P,e.next=3,n.logout(t);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)}))),r.state={redirect:!1},r}return Object(c.a)(n,[{key:"render",value:function(){return this.state.redirect?r.createElement(l.a,{to:(new Y).urlForRoot()}):r.createElement("div",{className:"component--GenericLogoutPage"},r.createElement(se,{user:this.props.user.state,topic:null,loading:this.props.user.updating}),r.createElement(U,null,r.createElement("h3",{className:"notice"},"Logout?"),r.createElement("p",null,"Are you sure? Your current session will be abandoned.")),r.createElement(U,null,r.createElement(V,{expand:!0},r.createElement("button",{onClick:this.onLogout},"Logout"))))}}]),n}(r.Component)),Pe=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).events={},r.state={lastPropValue:"",value:""},r.events={onChange:function(e){return r.onChange(e)}},r}return Object(c.a)(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.lastPropValue?{value:e.value,lastPropValue:e.value}:null}}]),Object(c.a)(n,[{key:"render",value:function(){return r.createElement("input",{value:this.state.value,onChange:this.events.onChange})}},{key:"onChange",value:function(e){var t=this,n=e.currentTarget.value;this.setState({value:n},(function(){t.props.onChange(n)}))}}]),n}(r.Component);n(76);var Fe,Ue=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onTagsChangedEvent=void 0,r.state={lastTags:[],tagEditValue:""},r.onTagsChangedEvent=function(e){return r.onTagsChanged(e)},r}return Object(c.a)(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){return function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}(e.value,t.lastTags)?null:{tagEditValue:e.value.join(", "),lastTags:e.value}}},{key:"onlyUnique",value:function(e,t,n){return n.indexOf(e)===t}}]),Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--TagPicker"},r.createElement(Pe,{value:this.state.tagEditValue,onChange:this.onTagsChangedEvent}),r.createElement("div",{className:"rendered"},r.createElement(pe,{tags:this.props.value,topic:null})))}},{key:"onTagsChanged",value:function(e){var t=this;this.setState({tagEditValue:e},(function(){var r=e.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).filter(n.onlyUnique);t.props.onChange(r)}))}}]),n}(r.Component),Ae=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onSaveEvent=void 0,r.onTitleChangedEvent=void 0,r.onTagsChangedEvent=void 0,r.onBodyChangedEvent=void 0,r.onTopicChanged=function(e){r.props.question.update(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{topic:e});case 1:case"end":return t.stop()}}),t)}))))},r.onBodyChangedEvent=function(e){return r.onBodyChanged(e)},r.onSaveEvent=function(e){return r.onSave(e)},r.onTagsChangedEvent=function(e){return r.onTagsChanged(e)},r.onTitleChangedEvent=function(e){return r.onTitleChanged(e)},r}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--Question"},r.createElement("form",{action:"",onSubmit:this.onSaveEvent},r.createElement(ie,{show:this.props.showTopic},r.createElement("fieldset",null,r.createElement(Pe,{value:this.props.question.state.topic,onChange:this.onTopicChanged}))),r.createElement("fieldset",null,r.createElement(Pe,{value:this.props.question.state.title,onChange:this.onTitleChangedEvent})),r.createElement("fieldset",null,r.createElement(H,{value:this.props.question.state.body,onChange:this.onBodyChangedEvent})),r.createElement("fieldset",null,r.createElement(Ue,{value:this.props.question.state.tags,onChange:this.onTagsChangedEvent})),r.createElement("fieldset",{className:"buttons"},r.createElement("button",{className:"submit"},this.props.saveText))))}},{key:"onSave",value:function(e){e.preventDefault(),this.props.submit()}},{key:"onTitleChanged",value:function(e){this.props.question.update(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{title:e});case 1:case"end":return t.stop()}}),t)}))))}},{key:"onTagsChanged",value:function(e){this.props.question.update(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{tags:e});case 1:case"end":return t.stop()}}),t)}))))}},{key:"onBodyChanged",value:function(e){this.props.question.update(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{body:e});case 1:case"end":return t.stop()}}),t)}))))}}]),n}(r.Component),Qe=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"askQuestion",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.state.question.save();case 4:if(null!==this.state.question.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved question"}));case 1:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return r=new je,e.next=8,r.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{topic:n.state.name});case 1:case"end":return e.stop()}}),e)}))));case 8:return e.abrupt("return",{question:r,topic:n});case 9:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{notice:null,question:new je,topic:new X}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this}}]),n}(Oe),Ve=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.askQuestion=function(){return r.data.askQuestion()},r.data=new Qe((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Qe((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(se,{user:this.props.user.state,topic:t.state,loading:this.data.updating}),r.createElement(Q,{error:this.data.state.question.error},r.createElement(ie,{show:e.state.questionId},r.createElement(V,{expand:!0},r.createElement(ue,{question:e,target:K.View},"View"))),r.createElement(G,{value:this.data.state.notice}),r.createElement(Ae,{showTopic:!1,submit:this.askQuestion,question:e,saveText:"Save"})))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component),Le=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"updateQuestion",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.state.question.save();case 4:if(null!==this.state.question.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved question"}));case 1:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteQuestion",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.question.delete();case 2:t=new Y,n=t.urlForTopic(this.state.topic.state.name),t.redirect(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,je.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.abrupt("return",{question:r,topic:n});case 11:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{notice:null,question:new je,topic:new X}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this}}]),n}(Oe),ze=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.onUpdateQuestionEvent=function(){return r.data.updateQuestion()},r.onDeleteQuestion=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,r.data.deleteQuestion();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.data=new Le((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Le((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(se,{user:this.props.user.state,topic:t.state,loading:this.data.updating}),r.createElement(Q,{error:this.data.state.question.error},r.createElement(V,{expand:!0},r.createElement(ue,{question:e,target:K.View},"Close")),r.createElement(G,{value:this.data.state.notice}),r.createElement(Ae,{showTopic:!0,submit:this.onUpdateQuestionEvent,question:e,saveText:"Save"})),r.createElement(Ce,{user:this.props.user,permissions:["CanDelete:Question"]},r.createElement(V,{expand:!0},r.createElement("p",null,"Delete this question?"),r.createElement("p",null,"Careful! No undo for this!"),r.createElement("button",{onClick:this.onDeleteQuestion},"Delete question"))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component);n(77);!function(e){e[e.Edit=0]="Edit"}(Fe||(Fe={}));var Me=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).nav=void 0,r.nav=new Y,r}return Object(c.a)(n,[{key:"render",value:function(){if(!this.props.question.state.questionId)return r.createElement(r.Fragment,null);var e=this.getUrl();return r.createElement("div",{className:"component--AnswerLink"},r.createElement("a",{href:e},this.props.children))}},{key:"getUrl",value:function(){switch(this.props.target){case Fe.Edit:return this.nav.urlForAnswerEdit(this.props.question.state.topic,this.props.question.state.questionId,this.props.answer.state.answerId);default:throw new Error("Unsupported target")}}}]),n}(r.Component),Re=(n(78),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onVote=function(){var t=Object(v.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n>0)){t.next=5;break}return t.next=3,e.props.answer.state.meta.voteUp();case 3:t.next=12;break;case 5:if(!(n<0)){t.next=10;break}return t.next=8,e.props.answer.state.meta.voteDown();case 8:t.next=12;break;case 10:return t.next=12,e.props.answer.state.meta.voteNeutral();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.answer.state.meta;return r.createElement("div",{className:"component--AnswerView"},r.createElement(ie,{show:this.props.answer.state.canEdit},r.createElement(V,{expand:!1},r.createElement(Me,{question:this.props.question,answer:this.props.answer,target:Fe.Edit},"Edit"))),r.createElement("div",{className:"metadata"},r.createElement(oe,{showStars:!1,userStars:0,userVotes:e.state.votes,votes:e.state.global.votes,onVote:this.onVote,onStar:null})),r.createElement("div",{className:"output"},r.createElement("div",{className:"rendered"},r.createElement(W,{markdown:this.props.answer.state.body})),r.createElement(ce,null,r.createElement(le,{user:this.props.answer.state.user}))))}}]),n}(r.Component)),Be=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--AnswerList"},this.renderAnswerList())}},{key:"renderAnswerList",value:function(){var e=this;return null==this.props.answers.state.instances?[]:this.props.answers.state.instances.map((function(t){return r.createElement(U,{key:t.state.answerId},r.createElement(Re,{answer:t,question:e.props.question,topic:e.props.topic}))}))}}]),n}(r.Component),We=(n(79),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onChangeSize=function(t){var n=Number(t.currentTarget.value);e.props.onChangeSize(n)},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.allowedSizes.map((function(e){return r.createElement("option",{key:e},e)}));return r.createElement("div",{className:"component--QuerySetPaginator"},r.createElement(A,{error:this.props.error}),r.createElement(U,null,r.createElement("div",{className:"parts"},r.createElement("div",{className:"part"},"Results per page:",r.createElement("select",{value:this.props.queryState.pageSize,onChange:this.onChangeSize},e)),r.createElement("div",{className:"part buttons"},r.createElement("div",null,r.createElement(ie,{show:this.props.queryState.page>0},r.createElement("button",{onClick:this.props.onPrev},"Prev")),r.createElement(ie,{show:this.props.queryState.moreResults},r.createElement("button",{onClick:this.props.onNext},"Next")))))))}}]),n}(r.PureComponent)),He=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"next",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.answers.next();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.answers.prev();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPageSize",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{pageSize:t});case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,je.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.abrupt("return",{question:r,topic:n});case 11:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answers:new $,notice:null,pageSize:5,question:new je,topic:new X}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this,this.state.answers.parent=this}},{key:"refreshData",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.question,e.next=3,we.search(n.state.questionId,t.state.pageSize);case 3:return r=e.sent,e.abrupt("return",{answers:r});case 5:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Oe),_e=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.onChangeSize=function(e){return r.data.setPageSize(e)},r.onNext=function(){return r.data.next()},r.onPrev=function(){return r.data.prev()},r.data=new He((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new He((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.answers,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicViewQuestionPage"},r.createElement(se,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(U,null,r.createElement(V,{expand:!1},r.createElement(ie,{show:e.state.canEdit},r.createElement(ue,{question:e,target:K.Edit},"Edit")),r.createElement(Z,{topic:e.state.topic,target:N.View},"Close")),r.createElement(he,{question:e})),r.createElement(Be,{topic:this.data.state.topic,question:this.data.state.question,answers:this.data.state.answers}),r.createElement(We,{allowedSizes:[1,5,10,25],queryState:t.state,onChangeSize:this.onChangeSize,onNext:this.onNext,onPrev:this.onPrev,error:t.error}),r.createElement(U,null,r.createElement(V,{expand:!0},r.createElement(ue,{question:e,target:K.Answer},r.createElement("button",null,"Answer Question")))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component),Ge=n(90),Je=(n(80),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).searchStream=new b.a,r.onChangeEvent=function(e){return r.searchStream.next(e)},r.searchStream.pipe(Object(Ge.a)(r.props.debounce)).subscribe(function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.props.onChange(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--SearchBar"},r.createElement(Q,{error:this.props.error},r.createElement("form",null,r.createElement("fieldset",null,r.createElement(Pe,{value:this.props.value,onChange:this.onChangeEvent})))))}}]),n}(r.Component));Je.defaultProps={debounce:200};n(81);var $e=function(e){return e.topic.state.icon?r.createElement("div",{className:"icon"},r.createElement("img",{src:e.topic.state.icon})):r.createElement(r.Fragment,null)},Xe=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.topic.state.description||"no description";return r.createElement("div",{className:"component--TopicView"},r.createElement($e,{topic:this.props.topic}),r.createElement("div",null,r.createElement("div",null,r.createElement(Z,{topic:this.props.topic.state.name,target:N.View},r.createElement("h2",null,this.props.topic.state.name))),r.createElement("div",null,e)))}}]),n}(r.Component),Ye=(n(82),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={page:0,pageSize:10},r}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--TopicList"},this.renderList())}},{key:"renderList",value:function(){return null==this.props.topics.state.instances?[]:this.props.topics.state.instances.map((function(e){return e.state.topicId?r.createElement("div",{className:"item",key:e.state.topicId},r.createElement(U,null,r.createElement(Xe,{topic:e}))):r.createElement(r.Fragment,null)}))}}]),n}(r.Component)),Ke=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"refresh",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchQuestionData(t.state.questionId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answer:null,canEdit:!1,meta:new ye,questionId:"",summary:"...",tags:[],title:"new answer",topic:"default",user:new be}}},{key:"fetchQuestionData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,a,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.getSummary(t);case 3:return r=e.sent,e.t0=ye,e.next=7,n.getMetadata(t);case 7:return e.t1=e.sent,a=new e.t0(e.t1),e.next=11,be.get(r.userId);case 11:return u=e.sent,e.abrupt("return",Object(s.a)({},r,{meta:a,user:u}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){this.state.meta.parent=this}}],[{key:"get",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new n).state.questionId=t,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $.fromQuery({fetchIds:n.searchForIds,fetchInstance:n.get,pageSize:t,query:e},r)}},{key:"searchForIds",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new ke,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(w),Ze=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){return Object(u.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"search",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{search:t});case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.update(Object(v.a)(f.a.mark((function e(){var n,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.search(t);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return r="topic:* ".concat(t),e.next=8,Ke.search(r,10);case 8:if(!(a=e.sent).error){e.next=11;break}throw a.error;case 11:return e.abrupt("return",{topics:n,questions:a});case 12:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.search(t.search);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.abrupt("return",{topics:n,search:t.search});case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{search:"",topics:new $,questions:new $}}},{key:"rebind",value:function(){this.state.topics.parent=this}}]),n}(Oe),et=(n(83),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.userVotes>0?["up","active"]:["up"],t=this.props.userVotes<0?["down","active"]:["down"],n=this.props.userStars>0?["star","active"]:["star"];return r.createElement("div",{className:"component--VotesAndStarsReadonly"},r.createElement("li",null,r.createElement("div",{className:e.join(" ")})),r.createElement("li",null,r.createElement("div",{className:"votes"},this.props.votes)),r.createElement("li",null,r.createElement("div",{className:t.join(" ")})),r.createElement("li",{className:"star-container"},r.createElement("div",{className:n.join(" ")})))}}]),n}(r.Component)),tt=(n(84),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.question.state.meta;return r.createElement("div",{className:"component--QuestionSummaryView"},r.createElement("div",{className:"metadata"},r.createElement(et,{userStars:e.state.star?1:0,userVotes:e.state.votes,votes:e.state.global.votes})),r.createElement("div",{className:"output"},r.createElement(ue,{question:this.props.question,target:K.View},r.createElement("h2",null,this.props.question.state.title)),r.createElement(pe,{tags:this.props.question.state.tags,topic:this.props.question.state.topic}),r.createElement(W,{markdown:this.props.question.state.summary}),this.renderAnswer(),r.createElement(ce,null,r.createElement(le,{user:this.props.question.state.user}))))}},{key:"renderAnswer",value:function(){return this.props.question.state.answer?r.createElement("div",{className:"answer"},r.createElement(W,{markdown:this.props.question.state.answer})):r.createElement(r.Fragment,null)}}]),n}(r.Component)),nt=(n(85),function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={page:0,pageSize:10},r}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--QuestionSummaryList"},this.renderList())}},{key:"renderList",value:function(){return null===this.props.questions.state.instances||0===this.props.questions.state.instances.length?this.props.showEmpty?r.createElement(U,null,"No questions found"):r.createElement(r.Fragment,null):this.props.questions.state.instances.map((function(e){return e.state.questionId?r.createElement(U,{key:e.state.questionId},r.createElement(tt,{question:e})):r.createElement(r.Fragment,null)}))}}]),n}(r.Component)),rt=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.onSearchEvent=function(e){return r.onSearch(e)},r.data=new Ze((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Ze((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return r.createElement(r.Fragment,null);var e=this.data.state.search,t=this.data.state.topics,n=this.data.state.questions;return r.createElement("div",{className:"component--TopicDiscoverPage"},r.createElement(se,{user:this.props.user.state,topic:null,loading:this.data.updating}),r.createElement(Je,{value:e,onChange:this.onSearchEvent,error:this.data.error}),r.createElement(Ye,{topics:t}),r.createElement(nt,{questions:n,showEmpty:!1}))}},{key:"guardInvalidState",value:function(){return null!==this.data}},{key:"onSearch",value:function(e){this.data.search(e)}}]),n}(r.Component),at=(n(86),function(e){return e.value?r.createElement("img",{src:e.value}):r.createElement(r.Fragment,null)}),st=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onChangeEvent=function(e){return r.onChange(e)},r.state={lastPropValue:"",loaded:0,loading:!1,total:0,value:""},r}return Object(c.a)(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.lastPropValue?{value:e.value,lastPropValue:e.value}:null}}]),Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--InlineImgEditor"},r.createElement("div",{className:"preview"},r.createElement(at,this.props)),this.state.loading?r.createElement("div",{className:"progress"},this.state.loaded," / ",this.state.total):r.createElement(r.Fragment,null),r.createElement("input",{type:"file",onChange:this.onChangeEvent}))}},{key:"onChange",value:function(e){var t=this;if(e.currentTarget.files&&e.currentTarget.files.length>0){var n=e.currentTarget.files[0],r=new FileReader;this.setState({loading:!0},(function(){r.onloadend=function(e){var n=r.result;t.setState({loaded:e.loaded,loading:!1,total:e.total,value:n},(function(){t.props.onChange(n)}))},r.onprogress=function(e){t.setState({loaded:e.loaded,total:e.total})},r.readAsDataURL(n)}))}}}]),n}(r.Component),ut=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onDescChangedEvent=function(t){return e.onDescChanged(t)},e.onIconChangedEvent=function(t){return e.onIconChanged(t)},e.onSaveEvent=function(t){return e.onSave(t)},e}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement("div",{className:"component--Question"},r.createElement("form",{action:"",onSubmit:this.onSaveEvent},r.createElement("fieldset",null,r.createElement(Pe,{value:this.props.topic.state.description,onChange:this.onDescChangedEvent})),r.createElement("fieldset",null,r.createElement(st,{value:this.props.topic.state.icon,onChange:this.onIconChangedEvent})),r.createElement("fieldset",{className:"buttons"},r.createElement("button",{className:"submit"},this.props.saveText))))}},{key:"onSave",value:function(e){e.preventDefault(),this.props.submit()}},{key:"onDescChanged",value:function(e){this.props.topic.update(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{description:e});case 1:case"end":return t.stop()}}),t)}))))}},{key:"onIconChanged",value:function(e){this.props.topic.update(Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{icon:e});case 1:case"end":return t.stop()}}),t)}))))}}]),n}(r.Component),ct=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"saveTopic",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.state.topic.save();case 4:if(null!==this.state.topic.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved topic"}));case 1:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteTopic",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.topic.delete();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.abrupt("return",{topic:n});case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{notice:null,topic:new X}}},{key:"rebind",value:function(){this.state.topic.parent=this}}]),n}(Oe),it=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.redirect=void 0,r.onSubmitFormEvent=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.data.saveTopic();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),r.onDeleteTopic=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,r.data.deleteTopic();case 3:r.data.state.topic.error||(r.redirect=!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.redirect=!1,r.data=new ct((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new ct((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(this.redirect){var e=(new Y).urlForRoot();return r.createElement(l.a,{to:e})}if(!this.guardInvalidState())return r.createElement(r.Fragment,null);var t=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(se,{user:this.props.user.state,topic:t.state,loading:this.data.updating}),r.createElement(Q,{error:this.data.state.topic.error},r.createElement(G,{value:this.data.state.notice}),r.createElement(ut,{submit:this.onSubmitFormEvent,topic:t,saveText:"Save"})),r.createElement(qe,{user:this.props.user,requirePermissions:["CanDelete:Topic"]},r.createElement(U,null,r.createElement(Ee,{title:"Unsafe commands"},r.createElement("form",null,r.createElement("fieldset",null,r.createElement(V,{expand:!0},r.createElement("p",null,"Accidentally created this topic?"),r.createElement("p",null,"If it has no questions it can be deleted."),r.createElement("p",null,"Careful! No undo for this!"),r.createElement("button",{onClick:this.onDeleteTopic},"Delete topic"))))))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component),ot=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){return Object(u.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"search",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{search:t});case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"next",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.questions.next();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.questions.prev();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPageSize",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{pageSize:t});case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.abrupt("return",{topic:n,search:t.search});case 6:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refreshData",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="topic:".concat(t.state.topic.state.name," ").concat(t.state.search),e.next=3,Ke.search(n,t.state.pageSize);case 3:if(!(r=e.sent).error){e.next=6;break}throw r.error;case 6:return e.abrupt("return",{questions:r});case 7:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{pageSize:5,questions:new $,search:"",topic:new X}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.questions.parent=this}}]),n}(Oe),pt=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.onSearchEvent=function(e){return r.data.search(e)},r.onChangeSize=function(e){return r.data.setPageSize(e)},r.onNext=function(){return r.data.next()},r.onPrev=function(){return r.data.prev()},r.data=new ot((function(){return r.forceUpdate()})),r.state={lastSearchProp:""},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new ot((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"componentDidUpdate",value:function(e,t,n){var r=this;this.props.search!==this.state.lastSearchProp&&this.setState({lastSearchProp:this.props.search},(function(){r.data.load(r.props)}))}},{key:"render",value:function(){if(!this.guardInvalidState())return r.createElement(r.Fragment,null);var e=this.data.state.questions,t=this.data.state.search,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicSearchPage"},r.createElement(se,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(Je,{error:this.data.error,value:t,onChange:this.onSearchEvent}),r.createElement(nt,{questions:e,showEmpty:!0}),r.createElement(We,{allowedSizes:[1,5,10,25],queryState:e.state,onChangeSize:this.onChangeSize,onNext:this.onNext,onPrev:this.onPrev,error:e.error}),r.createElement(U,null,r.createElement(V,{expand:!0},r.createElement(Z,{target:N.AddQuestion,topic:this.props.topic},r.createElement("button",null,"Ask question")))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component),lt=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"next",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.starQuestions.next();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.starQuestions.prev();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPageSize",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{pageSize:t});case 1:case"end":return e.stop()}}),e)}))));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshData();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{pageSize:5,starQuestions:new $}}},{key:"rebind",value:function(){this.state.starQuestions.parent=this}},{key:"refreshData",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.search("* topic:* is:star",t.state.pageSize);case 2:return n=e.sent,e.abrupt("return",{starQuestions:n});case 4:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Oe),ht=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).data=void 0,r.onChangeSize=function(e){return r.data.setPageSize(e)},r.onNext=function(){return r.data.next()},r.onPrev=function(){return r.data.prev()},r.data=new lt((function(){return r.forceUpdate()})),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new lt((function(){return e.forceUpdate()})),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.starQuestions;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(se,{user:this.props.user.state,topic:null,loading:this.data.updating}),r.createElement("div",null,r.createElement(U,null,r.createElement("h3",null,"Marked questions")),r.createElement(nt,{questions:e,showEmpty:!0}),r.createElement(We,{allowedSizes:[1,5,10,25],queryState:e.state,onChangeSize:this.onChangeSize,onNext:this.onNext,onPrev:this.onPrev,error:e.error})))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),n}(r.Component),ft=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).help=function(){return r.createElement(Te,null)},e.logout=function(){return r.createElement(De,{user:e.props.user})},e.self=function(){return r.createElement(ht,{user:e.props.user})},e.discoverTopics=function(){return r.createElement(rt,{user:e.props.user,search:"*"})},e.searchTopicWithQuery=function(t){return r.createElement(pt,{user:e.props.user,topic:t.match.params.name,search:t.match.params.query})},e.searchTopic=function(t){return r.createElement(pt,{user:e.props.user,topic:t.match.params.name,search:"*"})},e.editTopic=function(t){return r.createElement(it,{user:e.props.user,topic:t.match.params.name})},e.askQuestion=function(t){return r.createElement(Ve,{user:e.props.user,topic:t.match.params.name})},e.viewQuestion=function(t){return r.createElement(_e,{user:e.props.user,topic:t.match.params.name,question:t.match.params.questionId})},e.editQuestion=function(t){return r.createElement(ze,{user:e.props.user,topic:t.match.params.name,question:t.match.params.questionId})},e.editAnswer=function(t){return r.createElement(Ie,{user:e.props.user,topic:t.match.params.name,question:t.match.params.questionId,answer:t.match.params.answerId})},e.answerQuestion=function(t){return r.createElement(ge,{user:e.props.user,topic:t.match.params.name,question:t.match.params.questionId})},e}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement(p.a,null,r.createElement(l.d,null,r.createElement(l.b,{exact:!0,path:"/",render:this.discoverTopics}),r.createElement(l.b,{exact:!0,path:"/help",render:this.help}),r.createElement(l.b,{exact:!0,path:"/self",render:this.self}),r.createElement(l.b,{exact:!0,path:"/logout",render:this.logout}),r.createElement(l.b,{exact:!0,path:"/t/:name",render:this.searchTopic}),r.createElement(l.b,{exact:!0,path:"/t/:name/search/:query",render:this.searchTopicWithQuery}),r.createElement(l.b,{exact:!0,path:"/t/:name/edit",render:this.editTopic}),r.createElement(l.b,{exact:!0,path:"/t/:name/ask",render:this.askQuestion}),r.createElement(l.b,{exact:!0,path:"/t/:name/:questionId",render:this.viewQuestion}),r.createElement(l.b,{exact:!0,path:"/t/:name/:questionId/edit",render:this.editQuestion}),r.createElement(l.b,{exact:!0,path:"/t/:name/:questionId/answer",render:this.answerQuestion}),r.createElement(l.b,{exact:!0,path:"/t/:name/:questionId/answer/:answerId/edit",render:this.editAnswer})))}}]),n}(r.Component),vt=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).showLoginForm=function(){return r.createElement(L,{user:a.state.user})},a.showContent=function(){return a.props.settings.test.test?a.showTestContent():a.showMainContent()},a.showMainContent=function(){return r.createElement(ft,{user:a.state.user})},a.showTestContent=function(){return null==a.props.settings.test.testContent?r.createElement(r.Fragment,null):r.createElement(p.a,null,r.createElement(l.d,null,a.props.settings.test.testContent(a.state.user)))},a.state={user:new k},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e;e=this.props.settings,S.configure(new E(e.backendUrl)),O.configure((function(){return new q})),I.configure(e)}},{key:"render",value:function(){return r.createElement(y,null,r.createElement(z,{user:this.state.user,renderLoggedIn:this.showContent,renderLoggedOut:this.showLoginForm}))}}]),n}(r.Component),dt=function(e){return r.createElement(r.Fragment,null,r.createElement(ht,{user:e}))},mt=function(e){var t=Object(s.a)({},e.settings,{testContent:dt});return r.createElement(vt,{settings:t})},bt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function wt(){if("serviceWorker"in navigator){if(new URL("",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");bt?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):kt(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):kt(e)}))}}function kt(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}new E("/").get("config.json").then((function(e){a.render(r.createElement(mt,{settings:e}),document.getElementById("root")),wt()}))}]),[[41,1,2]]]);
//# sourceMappingURL=main.5b348bc2.chunk.js.map